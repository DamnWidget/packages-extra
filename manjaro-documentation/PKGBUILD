# Maintainer: Manuel Barrette (manb[at]manjaro[dot]org)
# Contributor: Jonathon Fernyhough (jonathon[at]manjaro[dot]org)

pkgbase=manjaro-documentation
pkgname=('manjaro-documentation')
pkgver=20160829
_gitcommit=39d105720d8f94e93e6a2be229174b1757c235aa
pkgrel=1
arch=('any')
url="https://github.com/manjaro/manjaro-user-guide"
makedepends=(lyx texlive-core texlive-latexextra texlive-pictures ttf-comfortaa ghostscript)
source=("manjaro-documentation-$pkgver-$pkgrel.tar.gz::$url/archive/$_gitcommit.tar.gz")
sha256sums=('8ba9b3a160ed5c189f16ea0ddfac5e2cf9639e7786a268440270aa9e1bb18ba2')

prepare() {
  cd ${srcdir}/manjaro-user-guide*
  lyx --export pdflatex manjaro-user-guide.lyx
  pdflatex manjaro-user-guide
  texindy --language english manjaro-user-guide.idx
  pdflatex manjaro-user-guide
  pdflatex manjaro-user-guide
  gs -dNOPAUSE -dBATCH -sDEVICE=pdfwrite -dCompatibilityLevel=1.4 -dPDFSETTINGS=/printer -sOutputFile=manjaro-user-guide-printer.pdf manjaro-user-guide.pdf
}

package() {
  pkgdesc="Manjaro Beginner User Guide"
  license=('CC-BY-SA 4.0')
  cd ${srcdir}/manjaro-user-guide*
  install -Dm644 manjaro-user-guide-printer.pdf "${pkgdir}/usr/share/doc/livecd/Beginner_User_Guide.pdf"
}
